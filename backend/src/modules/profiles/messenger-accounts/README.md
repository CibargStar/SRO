# –ú–æ–¥—É–ª—å –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤

–ú–æ–¥—É–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º–∏ –∫ –ø—Ä–æ—Ñ–∏–ª—è–º Chrome.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ö–∞–∂–¥—ã–π –ø—Ä–æ—Ñ–∏–ª—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤ (WhatsApp, Telegram –∏ –¥—Ä.). –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å/–≤—ã–∫–ª—é—á–∞—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞.

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

```
messenger-accounts/
‚îú‚îÄ‚îÄ messenger-accounts.schemas.ts        # Zod —Å—Ö–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ messenger-accounts.repository.ts     # –†–∞–±–æ—Ç–∞ —Å –ë–î (Prisma)
‚îú‚îÄ‚îÄ messenger-accounts.service.ts        # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ messenger-accounts.controller.ts     # HTTP handlers
‚îú‚îÄ‚îÄ messenger-accounts.routes.ts         # API –º–∞—Ä—à—Ä—É—Ç—ã
‚îú‚îÄ‚îÄ init-messenger-services.ts           # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
‚îú‚îÄ‚îÄ index.ts                             # –ü—É–±–ª–∏—á–Ω—ã–π API –º–æ–¥—É–ª—è
‚îî‚îÄ‚îÄ README.md                            # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–æ–¥—É–ª—è
```

## üóÑÔ∏è –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### MessengerService
–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤:
- `id` - UUID
- `name` - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∏–º—è (whatsapp, telegram)
- `displayName` - –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è
- `icon` - –ò–∫–æ–Ω–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `enabled` - –í–∫–ª—é—á–µ–Ω –ª–∏ –≤ —Å–∏—Å—Ç–µ–º–µ

### ProfileMessengerAccount
–ê–∫–∫–∞—É–Ω—Ç –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–π –∫ –ø—Ä–æ—Ñ–∏–ª—é:
- `id` - UUID
- `profileId` - ID –ø—Ä–æ—Ñ–∏–ª—è
- `serviceId` - ID –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞
- `isEnabled` - –í–∫–ª—é—á–µ–Ω –ª–∏ –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
- `status` - –°—Ç–∞—Ç—É—Å –≤—Ö–æ–¥–∞ (LOGGED_IN, NOT_LOGGED_IN, CHECKING, ERROR, UNKNOWN)
- `lastCheckedAt` - –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
- `lastStatusChangeAt` - –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
- `metadata` - JSON –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

### MessengerCheckConfig
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è ROOT):
- `id` - UUID
- `serviceId` - ID –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞
- `checkIntervalSeconds` - –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ (60-3600 —Å–µ–∫—É–Ω–¥)
- `enabled` - –í–∫–ª—é—á–µ–Ω –ª–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

## üì° API Endpoints

### –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤

#### GET `/api/messenger-services`
–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤

#### GET `/api/messenger-services/:id`
–ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ –ø–æ ID

### –ê–∫–∫–∞—É–Ω—Ç—ã –ø—Ä–æ—Ñ–∏–ª—è

#### GET `/api/profiles/:profileId/messenger-accounts`
–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤ –ø—Ä–æ—Ñ–∏–ª—è

#### POST `/api/profiles/:profileId/messenger-accounts`
–°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è
```json
{
  "serviceId": "uuid",
  "isEnabled": true,
  "metadata": {}
}
```

#### GET `/api/profiles/:profileId/messenger-accounts/:accountId`
–ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –ø–æ ID

#### PATCH `/api/profiles/:profileId/messenger-accounts/:accountId`
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞
```json
{
  "isEnabled": false,
  "metadata": {}
}
```

#### DELETE `/api/profiles/:profileId/messenger-accounts/:accountId`
–£–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞

#### POST `/api/profiles/:profileId/messenger-accounts/:accountId/enable`
–í–∫–ª—é—á–µ–Ω–∏–µ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è

#### POST `/api/profiles/:profileId/messenger-accounts/:accountId/disable`
–í—ã–∫–ª—é—á–µ–Ω–∏–µ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (ROOT only)

#### GET `/api/messenger-check-configs`
–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

#### PUT `/api/messenger-check-configs/:serviceId`
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
```json
{
  "checkIntervalSeconds": 300,
  "enabled": true
}
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î

```bash
cd backend
npx prisma migrate dev --name add_messenger_accounts
npx prisma generate
```

### 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞

–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤ (WhatsApp, Telegram) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ `init-messenger-services.ts`.

–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é:
```typescript
import { initMessengerServices } from './modules/profiles/messenger-accounts/init-messenger-services';
await initMessengerServices(prisma);
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –í—Å–µ endpoints —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ –∞–∫–∫–∞—É–Ω—Ç—ã —Å–≤–æ–∏—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Zod
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ ROOT –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ WhatsApp –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è

```bash
POST /api/profiles/{profileId}/messenger-accounts
{
  "serviceId": "{whatsapp-service-id}",
  "isEnabled": true,
  "metadata": {
    "phoneNumber": "+1234567890"
  }
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –ø—Ä–æ—Ñ–∏–ª—è

```bash
GET /api/profiles/{profileId}/messenger-accounts
```

### –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞

```bash
POST /api/profiles/{profileId}/messenger-accounts/{accountId}/enable
POST /api/profiles/{profileId}/messenger-accounts/{accountId}/disable
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ (ROOT)

```bash
PUT /api/messenger-check-configs/{serviceId}
{
  "checkIntervalSeconds": 600,
  "enabled": true
}
```

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã

–≠—Ç–∞–ø 1 (‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω):
- –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –∏ –±–∞–∑–æ–≤—ã–π CRUD
- –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤
- API endpoints –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏

–≠—Ç–∞–ø 2 (–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ):
- –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤ (Checkers)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ—Ñ–∏–ª—è
- –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ Winston:
- `backend/logs/combined.log` - –≤—Å–µ –ª–æ–≥–∏
- `backend/logs/error.log` - —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏

### Prisma Studio

–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î:
```bash
npx prisma studio
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ú–∏–≥—Ä–∞—Ü–∏—è –ë–î –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞** - –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–æ–¥—É–ª—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
2. **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å** - –æ–¥–∏–Ω –ø—Ä–æ—Ñ–∏–ª—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∞–∫–∫–∞—É–Ω—Ç –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞
3. **–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ** - –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è –≤—Å–µ –µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç—ã —É–¥–∞–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

