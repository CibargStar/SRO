# –ú–æ–¥—É–ª—å –∏–∑–æ–ª—è—Ü–∏–∏ –ø—Ä–æ—Ñ–∏–ª–µ–π Chrome

–ú–æ–¥—É–ª—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é –∏–∑–æ–ª—è—Ü–∏—é –ø—Ä–æ—Ñ–∏–ª–µ–π Chrome –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

```
isolation/
‚îú‚îÄ‚îÄ isolation.service.ts          # –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –∏–∑–æ–ª—è—Ü–∏–∏
‚îú‚îÄ‚îÄ profile-directory.manager.ts   # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º–∏ –ø—Ä–æ—Ñ–∏–ª–µ–π
‚îú‚îÄ‚îÄ index.ts                       # –ü—É–±–ª–∏—á–Ω—ã–π API –º–æ–¥—É–ª—è
‚îî‚îÄ‚îÄ README.md                      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ú–æ–¥—É–ª—å –∏–∑–æ–ª—è—Ü–∏–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

1. **–ò–∑–æ–ª—è—Ü–∏—é —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã** - –∫–∞–∂–¥—ã–π –ø—Ä–æ—Ñ–∏–ª—å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—É—Ç–µ–π** - –∑–∞—â–∏—Ç–∞ –æ—Ç path traversal –∞—Ç–∞–∫
3. **–í–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–æ–≤–µ—Ä–∫–∞ UUID –∏ –ø—É—Ç–µ–π
4. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º** - —Å–æ–∑–¥–∞–Ω–∏–µ, –ø—Ä–æ–≤–µ—Ä–∫–∞, —É–¥–∞–ª–µ–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
5. **–û—á–∏—Å—Ç–∫—É —Ä–µ—Å—É—Ä—Å–æ–≤** - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

–ö–∞–∂–¥—ã–π –ø—Ä–æ—Ñ–∏–ª—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ:

```
./profiles/
  {userId}/
    {profileId}/
      chrome-data/        # –î–∞–Ω–Ω—ã–µ Chrome –ø—Ä–æ—Ñ–∏–ª—è
      logs/               # –õ–æ–≥–∏ –ø—Ä–æ—Ñ–∏–ª—è
```

**–ü—Ä–∏–º–µ—Ä:**
```
./profiles/
  550e8400-e29b-41d4-a716-446655440000/
    a1b2c3d4-e5f6-7890-abcd-ef1234567890/
      chrome-data/
      logs/
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ó–∞—â–∏—Ç–∞ –æ—Ç path traversal

–ú–æ–¥—É–ª—å –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –∞—Ç–∞–∫ —Ç–∏–ø–∞ path traversal —á–µ—Ä–µ–∑:

1. **–í–∞–ª–∏–¥–∞—Ü–∏—é –ø—É—Ç–µ–π** - –ø—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –ø—É—Ç—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –±–∞–∑–æ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
2. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –ø—É—Ç–µ–π** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `resolve()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –ø—É—Ç–µ–π
3. **–ü—Ä–æ–≤–µ—Ä–∫—É —Å–∏–º–≤–æ–ª–æ–≤** - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ `..` –∏ `~` –≤ –ø—É—Ç—è—Ö
4. **–í–∞–ª–∏–¥–∞—Ü–∏—é UUID** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø—Ä–æ—Ñ–∏–ª—è

### –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

- ‚úÖ UUID —Ñ–æ—Ä–º–∞—Ç –¥–ª—è `userId` –∏ `profileId`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Ç–µ–π –ø–µ—Ä–µ–¥ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏

## üì° API

### IsolationService

#### `createIsolatedProfileDirectory(userId, profileId)`
–°–æ–∑–¥–∞–µ—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è.

```typescript
const isolationService = new IsolationService('./profiles');
const profilePath = await isolationService.createIsolatedProfileDirectory(userId, profileId);
```

#### `deleteIsolatedProfileDirectory(userId, profileId)`
–£–¥–∞–ª—è–µ—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ—Ñ–∏–ª—è.

```typescript
await isolationService.deleteIsolatedProfileDirectory(userId, profileId);
```

#### `profileDirectoryExists(userId, profileId)`
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è.

```typescript
const exists = await isolationService.profileDirectoryExists(userId, profileId);
```

#### `getProfilePath(userId, profileId)`
–ü–æ–ª—É—á–∞–µ—Ç –ø—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è.

```typescript
const path = isolationService.getProfilePath(userId, profileId);
```

#### `getProfileDirectorySize(userId, profileId)`
–ü–æ–ª—É—á–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è –≤ –±–∞–π—Ç–∞—Ö.

```typescript
const size = await isolationService.getProfileDirectorySize(userId, profileId);
```

#### `clearProfileDirectory(userId, profileId)`
–û—á–∏—â–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è (–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–∞–º—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é).

```typescript
await isolationService.clearProfileDirectory(userId, profileId);
```

### ProfileDirectoryManager

–ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º–∏. –û–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `IsolationService`.

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```typescript
import { IsolationService } from './isolation';

const isolationService = new IsolationService('./profiles');

// –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
const profilePath = await isolationService.createIsolatedProfileDirectory(userId, profileId);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è
const exists = await isolationService.profileDirectoryExists(userId, profileId);

// –£–¥–∞–ª–µ–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
await isolationService.deleteIsolatedProfileDirectory(userId, profileId);
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ProfilesService

`IsolationService` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `ProfilesService`:

```typescript
// –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è
const profile = await profilesService.createProfile(userId, data);
// –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

// –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è
await profilesService.deleteProfile(profileId, userId);
// –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —É–¥–∞–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

## ‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ú–æ–¥—É–ª—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –æ—à–∏–±–∫–∏:

1. **Path traversal –ø–æ–ø—ã—Ç–∫–∏** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
2. **–ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ UUID** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏
3. **–û—à–∏–±–∫–∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã** - –ª–æ–≥–∏—Ä—É–µ—Ç –∏ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É
4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞** - –ª–æ–≥–∏—Ä—É–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

–í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ Winston logger.

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–ª—è—Ü–∏–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

```bash
# –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
ls -la ./profiles/{userId}/{profileId}/
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–æ–ª—è—Ü–∏–∏

1. –°–æ–∑–¥–∞–π—Ç–µ –¥–≤–∞ –ø—Ä–æ—Ñ–∏–ª—è –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è —Å–≤–æ—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—É—Ç–∏ –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è

```bash
# –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
ls -la ./profiles/{userId}/
# –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ—Ñ–∏–ª—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —É–¥–∞–ª–µ–Ω–∞
```

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –ò–∑–æ–ª—è—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ Chrome (–æ—Ç–¥–µ–ª—å–Ω—ã–µ PID)
- [ ] –ò–∑–æ–ª—è—Ü–∏—è —Å–µ—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏)
- [ ] –ò–∑–æ–ª—è—Ü–∏—è –ø–∞–º—è—Ç–∏ (cgroups –Ω–∞ Linux)
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π

## üìö –°–≤—è–∑–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [Profiles Module README](../README.md)
- [Testing Guide](../TESTING_GUIDE.md)









